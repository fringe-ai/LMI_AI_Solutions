<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">anomaly_detectors_v1.html</title>
      <link href="assets/style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">anomaly_detectors_v1.html</h1>
    <p>Report generated on 27-Jan-2025 at 19:58:45 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">8 tests took 00:04:34.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" disabled/>
            <span class="failed">0 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">8 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.10.12&#34;, &#34;Platform&#34;: &#34;Linux-6.8.0-51-generic-x86_64-with-glibc2.35&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.1.1&#34;, &#34;pluggy&#34;: &#34;1.4.0&#34;}, &#34;Plugins&#34;: {&#34;hydra-core&#34;: &#34;1.3.2&#34;, &#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;xdoctest&#34;: &#34;1.0.2&#34;, &#34;rerunfailures&#34;: &#34;14.0&#34;, &#34;hypothesis&#34;: &#34;5.35.1&#34;, &#34;xdist&#34;: &#34;3.5.0&#34;, &#34;flakefinder&#34;: &#34;1.1.0&#34;, &#34;shard&#34;: &#34;0.1.2&#34;}}, &#34;tests&#34;: {&#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib&#34;, &#34;duration&#34;: &#34;00:00:02&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:02&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib_api&#34;, &#34;duration&#34;: &#34;00:00:01&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_compare_results_with_anomalib_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:01&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup&#34;, &#34;duration&#34;: &#34;612 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;612 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING:Tiler:pad img from [672, 640] to (672, 672)\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:anomaly_model2.py:105 init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING  Tiler:tiler.py:158 pad img from [672, 640] to (672, 672)\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup_api&#34;, &#34;duration&#34;: &#34;619 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_warmup_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;619 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING:Tiler:pad img from [672, 640] to (672, 672)\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING:Tiler:pad img from [256, 224] to (336, 224)\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:anomaly_model2.py:105 init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING  Tiler:tiler.py:158 pad img from [672, 640] to (672, 672)\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:anomaly_model2.py:105 init tiler with tile=[224, 224], stride=112, mode=padding\nWARNING  Tiler:tiler.py:158 pad img from [256, 224] to (336, 224)\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model&#34;, &#34;duration&#34;: &#34;00:00:10&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:10&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=224, mode=interpolation\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:77.97194934511214\nINFO:AnomalyModel v1:Min Proc Time: 0.45456528663635254\nINFO:AnomalyModel v1:Max Proc Time: 0.475297212600708\nINFO:AnomalyModel v1:Avg Proc Time: 0.461466908454895\nINFO:AnomalyModel v1:Median Proc Time: 0.457943320274353\nINFO:AnomalyModel v1:Test results saved to tests/assets/validation/ad_v1\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:19.995066051841665\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:55.68547422031294\nINFO:AnomalyModel v1:Min Proc Time: 0.027800798416137695\nINFO:AnomalyModel v1:Max Proc Time: 0.029813289642333984\nINFO:AnomalyModel v1:Avg Proc Time: 0.028246700763702393\nINFO:AnomalyModel v1:Median Proc Time: 0.0279085636138916\nINFO:AnomalyModel v1:Test results saved to tests/assets/validation/ad_v1\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:anomaly_model2.py:105 init tiler with tile=[224, 224], stride=224, mode=interpolation\nINFO     AnomalyModel v1:base.py:253 8 images from tests/assets/images/nvtec-ad\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:282 Computing anomaly score PDF for all data.\nINFO     AnomalyModel v1:base.py:324 Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO     AnomalyModel v1:base.py:329 Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO     AnomalyModel v1:base.py:338 Anomaly max set to 97 percentile:77.97194934511214\nINFO     AnomalyModel v1:base.py:369 Min Proc Time: 0.45456528663635254\nINFO     AnomalyModel v1:base.py:370 Max Proc Time: 0.475297212600708\nINFO     AnomalyModel v1:base.py:371 Avg Proc Time: 0.461466908454895\nINFO     AnomalyModel v1:base.py:372 Median Proc Time: 0.457943320274353\nINFO     AnomalyModel v1:base.py:373 Test results saved to tests/assets/validation/ad_v1\nINFO     AnomalyModel v1:base.py:376 Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:base.py:253 8 images from tests/assets/images/nvtec-ad\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nINFO     AnomalyModel v1:base.py:282 Computing anomaly score PDF for all data.\nINFO     AnomalyModel v1:base.py:324 Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\nINFO     AnomalyModel v1:base.py:329 Anomaly patch threshold for 50% patch failure rate:19.995066051841665\nINFO     AnomalyModel v1:base.py:338 Anomaly max set to 97 percentile:55.68547422031294\nINFO     AnomalyModel v1:base.py:369 Min Proc Time: 0.027800798416137695\nINFO     AnomalyModel v1:base.py:370 Max Proc Time: 0.029813289642333984\nINFO     AnomalyModel v1:base.py:371 Avg Proc Time: 0.028246700763702393\nINFO     AnomalyModel v1:base.py:372 Median Proc Time: 0.0279085636138916\nINFO     AnomalyModel v1:base.py:373 Test results saved to tests/assets/validation/ad_v1\nINFO     AnomalyModel v1:base.py:376 Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model_api&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model_api&#34;, &#34;duration&#34;: &#34;00:00:10&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_model_api&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:10&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=224, mode=interpolation\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:77.97194934511214\nINFO:AnomalyModel v1:Min Proc Time: 0.45346713066101074\nINFO:AnomalyModel v1:Max Proc Time: 0.505866289138794\nINFO:AnomalyModel v1:Avg Proc Time: 0.46266457438468933\nINFO:AnomalyModel v1:Median Proc Time: 0.45668649673461914\nINFO:AnomalyModel v1:Test results saved to tests/assets/validation/ad_v1\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:19.995066051841665\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:55.68547422031294\nINFO:AnomalyModel v1:Min Proc Time: 0.02228856086730957\nINFO:AnomalyModel v1:Max Proc Time: 0.028328657150268555\nINFO:AnomalyModel v1:Avg Proc Time: 0.02679920196533203\nINFO:AnomalyModel v1:Median Proc Time: 0.02778458595275879\nINFO:AnomalyModel v1:Test results saved to tests/assets/validation/ad_v1\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:anomaly_model2.py:105 init tiler with tile=[224, 224], stride=224, mode=interpolation\nINFO     AnomalyModel v1:base.py:253 8 images from tests/assets/images/nvtec-ad\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING  Tiler:tiler.py:156 resize img from [1024, 1024] to (1120, 1120)\nINFO     AnomalyModel v1:base.py:282 Computing anomaly score PDF for all data.\nINFO     AnomalyModel v1:base.py:324 Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO     AnomalyModel v1:base.py:329 Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO     AnomalyModel v1:base.py:338 Anomaly max set to 97 percentile:77.97194934511214\nINFO     AnomalyModel v1:base.py:369 Min Proc Time: 0.45346713066101074\nINFO     AnomalyModel v1:base.py:370 Max Proc Time: 0.505866289138794\nINFO     AnomalyModel v1:base.py:371 Avg Proc Time: 0.46266457438468933\nINFO     AnomalyModel v1:base.py:372 Median Proc Time: 0.45668649673461914\nINFO     AnomalyModel v1:base.py:373 Test results saved to tests/assets/validation/ad_v1\nINFO     AnomalyModel v1:base.py:376 Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     AnomalyModel v1:base.py:253 8 images from tests/assets/images/nvtec-ad\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/003-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/002-good.png.\nINFO     AnomalyModel v1:base.py:265 Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nINFO     AnomalyModel v1:base.py:282 Computing anomaly score PDF for all data.\nINFO     AnomalyModel v1:base.py:324 Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\nINFO     AnomalyModel v1:base.py:329 Anomaly patch threshold for 50% patch failure rate:19.995066051841665\nINFO     AnomalyModel v1:base.py:338 Anomaly max set to 97 percentile:55.68547422031294\nINFO     AnomalyModel v1:base.py:369 Min Proc Time: 0.02228856086730957\nINFO     AnomalyModel v1:base.py:370 Max Proc Time: 0.028328657150268555\nINFO     AnomalyModel v1:base.py:371 Avg Proc Time: 0.02679920196533203\nINFO     AnomalyModel v1:base.py:372 Median Proc Time: 0.02778458595275879\nINFO     AnomalyModel v1:base.py:373 Test results saved to tests/assets/validation/ad_v1\nINFO     AnomalyModel v1:base.py:376 Threshold options:\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Threshold             |   4.34 |  10.6 |  16.9 |  23.2 | 29.5  | 35.8   | 42.1     | 48.4      | 54.7      | 61        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Patch Defect  | 100    |  99.7 |  78   |  23.2 |  2.34 |  0.104 |  0.00252 |  3.88e-05 |  4.22e-07 |  3.48e-09 |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n| Prob of Sample Defect | 100    | 100   | 100   | 100   | 62.5  | 25     | 25       | 12.5      | 12.5      |  0        |\n+-----------------------+--------+-------+-------+-------+-------+--------+----------+-----------+-----------+-----------+\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_annotate&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_annotate&#34;, &#34;duration&#34;: &#34;00:00:01&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_annotate&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:01&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:test_anomaly_model2:improved proc time from 0.0285 to 0.0032\nINFO:test_anomaly_model2:improved proc time from 0.0244 to 0.0030\nINFO:test_anomaly_model2:improved proc time from 0.0274 to 0.0030\nINFO:test_anomaly_model2:improved proc time from 0.0270 to 0.0028\nINFO:test_anomaly_model2:improved proc time from 0.0244 to 0.0029\nINFO:test_anomaly_model2:improved proc time from 0.0279 to 0.0032\nINFO:test_anomaly_model2:improved proc time from 0.0280 to 0.0029\nINFO:test_anomaly_model2:improved proc time from 0.0262 to 0.0030\n\n------------------------------ Captured log call -------------------------------\nINFO     AnomalyModel v1:anomaly_model2.py:57 Loading model: tests/assets/models/ad/model_v1.pt\nINFO     AnomalyModel v1:anomaly_model2.py:86 Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0285 to 0.0032\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0244 to 0.0030\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0274 to 0.0030\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0270 to 0.0028\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0244 to 0.0029\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0279 to 0.0032\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0280 to 0.0029\nINFO     test_anomaly_model2:test_anomaly_model2.py:197 improved proc time from 0.0262 to 0.0030\n\n&#34;}], &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_cmds&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_cmds&#34;, &#34;duration&#34;: &#34;00:04:09&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;tests/anomaly_detectors/anomalib_lmi/test_anomaly_model2.py::test_cmds&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:04:09&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;---------------------------- Captured stderr setup -----------------------------\nINFO:test_anomaly_model2:Skipping adding root path to sys.path\n\n------------------------------ Captured log setup ------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:26 Skipping adding root path to sys.path\n\n----------------------------- Captured stderr call -----------------------------\nINFO:test_anomaly_model2:running cmd: python -m anomalib_lmi.anomaly_model2 test -i tests/assets/models/ad/model_v1.pt -d tests/assets/images/nvtec-ad -o /tmp/tmpu9uixbhn -g -p --tile 224 224 --stride 224 224 --resize\nINFO:test_anomaly_model2:\nINFO:test_anomaly_model2:INFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nWARNING:anomalib:OpenVINO is not installed. Please install OpenVINO to use OpenVINOInferencer.\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=[224, 224], mode=interpolation\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:77.97194934511214\nINFO:AnomalyModel v1:Min Proc Time: 0.4532439708709717\nINFO:AnomalyModel v1:Max Proc Time: 0.7421057224273682\nINFO:AnomalyModel v1:Avg Proc Time: 0.4925464689731598\nINFO:AnomalyModel v1:Median Proc Time: 0.4577251672744751\nINFO:AnomalyModel v1:Test results saved to /tmp/tmpu9uixbhn\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n\nINFO:test_anomaly_model2:running cmd: python -m anomalib_lmi.anomaly_model2 convert -i tests/assets/models/ad/model_v1.pt -o /tmp/tmpu9uixbhn/recon --hw 1120 1120 --tile 224 224 --stride 224 224\nINFO:test_anomaly_model2:&amp;amp;&amp;amp;&amp;amp;&amp;amp; RUNNING TensorRT.trtexec [TensorRT v8603] # trtexec --onnx=/tmp/tmpu9uixbhn/recon/model.onnx --saveEngine=/tmp/tmpu9uixbhn/recon/model.engine --memPoolSize=workspace:4096 --fp16\n[01/27/2025-19:54:53] [I] === Model Options ===\n[01/27/2025-19:54:53] [I] Format: ONNX\n[01/27/2025-19:54:53] [I] Model: /tmp/tmpu9uixbhn/recon/model.onnx\n[01/27/2025-19:54:53] [I] Output:\n[01/27/2025-19:54:53] [I] === Build Options ===\n[01/27/2025-19:54:53] [I] Max batch: explicit batch\n[01/27/2025-19:54:53] [I] Memory Pools: workspace: 4096 MiB, dlaSRAM: default, dlaLocalDRAM: default, dlaGlobalDRAM: default\n[01/27/2025-19:54:53] [I] minTiming: 1\n[01/27/2025-19:54:53] [I] avgTiming: 8\n[01/27/2025-19:54:53] [I] Precision: FP32+FP16\n[01/27/2025-19:54:53] [I] LayerPrecisions: \n[01/27/2025-19:54:53] [I] Layer Device Types: \n[01/27/2025-19:54:53] [I] Calibration: \n[01/27/2025-19:54:53] [I] Refit: Disabled\n[01/27/2025-19:54:53] [I] Version Compatible: Disabled\n[01/27/2025-19:54:53] [I] ONNX Native InstanceNorm: Disabled\n[01/27/2025-19:54:53] [I] TensorRT runtime: full\n[01/27/2025-19:54:53] [I] Lean DLL Path: \n[01/27/2025-19:54:53] [I] Tempfile Controls: { in_memory: allow, temporary: allow }\n[01/27/2025-19:54:53] [I] Exclude Lean Runtime: Disabled\n[01/27/2025-19:54:53] [I] Sparsity: Disabled\n[01/27/2025-19:54:53] [I] Safe mode: Disabled\n[01/27/2025-19:54:53] [I] Build DLA standalone loadable: Disabled\n[01/27/2025-19:54:53] [I] Allow GPU fallback for DLA: Disabled\n[01/27/2025-19:54:53] [I] DirectIO mode: Disabled\n[01/27/2025-19:54:53] [I] Restricted mode: Disabled\n[01/27/2025-19:54:53] [I] Skip inference: Disabled\n[01/27/2025-19:54:53] [I] Save engine: /tmp/tmpu9uixbhn/recon/model.engine\n[01/27/2025-19:54:53] [I] Load engine: \n[01/27/2025-19:54:53] [I] Profiling verbosity: 0\n[01/27/2025-19:54:53] [I] Tactic sources: Using default tactic sources\n[01/27/2025-19:54:53] [I] timingCacheMode: local\n[01/27/2025-19:54:53] [I] timingCacheFile: \n[01/27/2025-19:54:53] [I] Heuristic: Disabled\n[01/27/2025-19:54:53] [I] Preview Features: Use default preview flags.\n[01/27/2025-19:54:53] [I] MaxAuxStreams: -1\n[01/27/2025-19:54:53] [I] BuilderOptimizationLevel: -1\n[01/27/2025-19:54:53] [I] Input(s)s format: fp32:CHW\n[01/27/2025-19:54:53] [I] Output(s)s format: fp32:CHW\n[01/27/2025-19:54:53] [I] Input build shapes: model\n[01/27/2025-19:54:53] [I] Input calibration shapes: model\n[01/27/2025-19:54:53] [I] === System Options ===\n[01/27/2025-19:54:53] [I] Device: 0\n[01/27/2025-19:54:53] [I] DLACore: \n[01/27/2025-19:54:53] [I] Plugins:\n[01/27/2025-19:54:53] [I] setPluginsToSerialize:\n[01/27/2025-19:54:53] [I] dynamicPlugins:\n[01/27/2025-19:54:53] [I] ignoreParsedPluginLibs: 0\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] === Inference Options ===\n[01/27/2025-19:54:53] [I] Batch: Explicit\n[01/27/2025-19:54:53] [I] Input inference shapes: model\n[01/27/2025-19:54:53] [I] Iterations: 10\n[01/27/2025-19:54:53] [I] Duration: 3s (+ 200ms warm up)\n[01/27/2025-19:54:53] [I] Sleep time: 0ms\n[01/27/2025-19:54:53] [I] Idle time: 0ms\n[01/27/2025-19:54:53] [I] Inference Streams: 1\n[01/27/2025-19:54:53] [I] ExposeDMA: Disabled\n[01/27/2025-19:54:53] [I] Data transfers: Enabled\n[01/27/2025-19:54:53] [I] Spin-wait: Disabled\n[01/27/2025-19:54:53] [I] Multithreading: Disabled\n[01/27/2025-19:54:53] [I] CUDA Graph: Disabled\n[01/27/2025-19:54:53] [I] Separate profiling: Disabled\n[01/27/2025-19:54:53] [I] Time Deserialize: Disabled\n[01/27/2025-19:54:53] [I] Time Refit: Disabled\n[01/27/2025-19:54:53] [I] NVTX verbosity: 0\n[01/27/2025-19:54:53] [I] Persistent Cache Ratio: 0\n[01/27/2025-19:54:53] [I] Inputs:\n[01/27/2025-19:54:53] [I] === Reporting Options ===\n[01/27/2025-19:54:53] [I] Verbose: Disabled\n[01/27/2025-19:54:53] [I] Averages: 10 inferences\n[01/27/2025-19:54:53] [I] Percentiles: 90,95,99\n[01/27/2025-19:54:53] [I] Dump refittable layers:Disabled\n[01/27/2025-19:54:53] [I] Dump output: Disabled\n[01/27/2025-19:54:53] [I] Profile: Disabled\n[01/27/2025-19:54:53] [I] Export timing to JSON file: \n[01/27/2025-19:54:53] [I] Export output to JSON file: \n[01/27/2025-19:54:53] [I] Export profile to JSON file: \n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] === Device Information ===\n[01/27/2025-19:54:53] [I] Selected Device: NVIDIA GeForce RTX 4070 Laptop GPU\n[01/27/2025-19:54:53] [I] Compute Capability: 8.9\n[01/27/2025-19:54:53] [I] SMs: 36\n[01/27/2025-19:54:53] [I] Device Global Memory: 7935 MiB\n[01/27/2025-19:54:53] [I] Shared Memory per SM: 100 KiB\n[01/27/2025-19:54:53] [I] Memory Bus Width: 128 bits (ECC disabled)\n[01/27/2025-19:54:53] [I] Application Compute Clock Rate: 1.23 GHz\n[01/27/2025-19:54:53] [I] Application Memory Clock Rate: 8.001 GHz\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] Note: The application clock rates do not reflect the actual clock rates that the GPU is currently running at.\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] TensorRT version: 8.6.3\n[01/27/2025-19:54:53] [I] Loading standard plugins\n[01/27/2025-19:54:54] [I] [TRT] [MemUsageChange] Init CUDA: CPU +2, GPU +0, now: CPU 23, GPU 2498 (MiB)\n[01/27/2025-19:54:58] [I] [TRT] [MemUsageChange] Init builder kernel library: CPU +1453, GPU +268, now: CPU 1552, GPU 2766 (MiB)\n[01/27/2025-19:54:58] [I] Start parsing network model.\n[01/27/2025-19:54:58] [I] [TRT] ----------------------------------------------------------------\n[01/27/2025-19:54:58] [I] [TRT] Input filename:   /tmp/tmpu9uixbhn/recon/model.onnx\n[01/27/2025-19:54:58] [I] [TRT] ONNX IR version:  0.0.7\n[01/27/2025-19:54:58] [I] [TRT] Opset version:    14\n[01/27/2025-19:54:58] [I] [TRT] Producer name:    pytorch\n[01/27/2025-19:54:58] [I] [TRT] Producer version: 2.3.0\n[01/27/2025-19:54:58] [I] [TRT] Domain:           \n[01/27/2025-19:54:58] [I] [TRT] Model version:    0\n[01/27/2025-19:54:58] [I] [TRT] Doc string:       \n[01/27/2025-19:54:58] [I] [TRT] ----------------------------------------------------------------\n[01/27/2025-19:54:58] [I] Finished parsing network model. Parse time: 0.148756\n[01/27/2025-19:54:58] [I] [TRT] Graph optimization time: 0.0754481 seconds.\n[01/27/2025-19:54:58] [I] [TRT] Local timing cache in use. Profiling results in this builder pass will not be stored.\n[01/27/2025-19:58:40] [I] [TRT] Detected 1 inputs and 2 output network tensors.\n[01/27/2025-19:58:40] [I] [TRT] Total Host Persistent Memory: 267232\n[01/27/2025-19:58:40] [I] [TRT] Total Device Persistent Memory: 26624\n[01/27/2025-19:58:40] [I] [TRT] Total Scratch Memory: 963072\n[01/27/2025-19:58:40] [I] [TRT] [MemUsageStats] Peak memory usage of TRT CPU/GPU memory allocators: CPU 65 MiB, GPU 1372 MiB\n[01/27/2025-19:58:40] [I] [TRT] [BlockAssignment] Started assigning block shifts. This will take 71 steps to complete.\n[01/27/2025-19:58:40] [I] [TRT] [BlockAssignment] Algorithm ShiftNTopDown took 1.38286ms to assign 8 blocks to 71 nodes requiring 179657728 bytes.\n[01/27/2025-19:58:40] [I] [TRT] Total Activation Memory: 179656704\n[01/27/2025-19:58:40] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in building engine: CPU +51, GPU +59, now: CPU 51, GPU 59 (MiB)\n[01/27/2025-19:58:40] [I] Engine built in 226.909 sec.\n[01/27/2025-19:58:41] [I] [TRT] Loaded engine size: 60 MiB\n[01/27/2025-19:58:41] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in engine deserialization: CPU +0, GPU +58, now: CPU 0, GPU 58 (MiB)\n[01/27/2025-19:58:41] [I] Engine deserialized in 0.0186728 sec.\n[01/27/2025-19:58:41] [I] [TRT] [MS] Running engine with multi stream info\n[01/27/2025-19:58:41] [I] [TRT] [MS] Number of aux streams is 1\n[01/27/2025-19:58:41] [I] [TRT] [MS] Number of total worker streams is 2\n[01/27/2025-19:58:41] [I] [TRT] [MS] The main stream provided by execute/enqueue calls is the first worker stream\n[01/27/2025-19:58:41] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in IExecutionContext creation: CPU +0, GPU +171, now: CPU 0, GPU 229 (MiB)\n[01/27/2025-19:58:41] [I] Setting persistentCacheLimit to 0 bytes.\n[01/27/2025-19:58:41] [I] Using random values for input input\n[01/27/2025-19:58:41] [I] Input binding for input with dimensions 25x3x224x224 is created.\n[01/27/2025-19:58:41] [I] Output binding for 580 with dimensions 25 is created.\n[01/27/2025-19:58:41] [I] Output binding for output with dimensions 25x1x224x224 is created.\n[01/27/2025-19:58:41] [I] Starting inference\n[01/27/2025-19:58:44] [I] Warmup completed 7 queries over 200 ms\n[01/27/2025-19:58:44] [I] Timing trace has 102 queries over 3.11496 s\n[01/27/2025-19:58:44] [I] \n[01/27/2025-19:58:44] [I] === Trace details ===\n[01/27/2025-19:58:44] [I] Trace averages of 10 runs:\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.6797 ms - Host latency: 33.3605 ms (enqueue 0.903571 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 29.8086 ms - Host latency: 32.9657 ms (enqueue 0.810129 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.3813 ms - Host latency: 33.5937 ms (enqueue 0.966522 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.3737 ms - Host latency: 33.5136 ms (enqueue 1.02056 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.1221 ms - Host latency: 33.2979 ms (enqueue 1.10021 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.0676 ms - Host latency: 33.2281 ms (enqueue 1.25354 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.2823 ms - Host latency: 33.4353 ms (enqueue 0.983972 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.2949 ms - Host latency: 33.4742 ms (enqueue 1.0873 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.1419 ms - Host latency: 33.2875 ms (enqueue 1.05886 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.154 ms - Host latency: 33.2935 ms (enqueue 1.06074 ms)\n[01/27/2025-19:58:44] [I] \n[01/27/2025-19:58:44] [I] === Performance summary ===\n[01/27/2025-19:58:44] [I] Throughput: 32.7452 qps\n[01/27/2025-19:58:44] [I] Latency: min = 32.5557 ms, max = 34.3112 ms, mean = 33.3445 ms, median = 33.2726 ms, percentile(90%) = 33.8351 ms, percentile(95%) = 34.1353 ms, percentile(99%) = 34.2988 ms\n[01/27/2025-19:58:44] [I] Enqueue Time: min = 0.376221 ms, max = 1.87842 ms, mean = 1.0252 ms, median = 1.00912 ms, percentile(90%) = 1.33667 ms, percentile(95%) = 1.57349 ms, percentile(99%) = 1.84973 ms\n[01/27/2025-19:58:44] [I] H2D Latency: min = 1.62901 ms, max = 2.55597 ms, mean = 2.36164 ms, median = 2.38074 ms, percentile(90%) = 2.46704 ms, percentile(95%) = 2.47839 ms, percentile(99%) = 2.49561 ms\n[01/27/2025-19:58:44] [I] GPU Compute Time: min = 29.5557 ms, max = 31.9836 ms, mean = 30.2298 ms, median = 30.1394 ms, percentile(90%) = 30.8726 ms, percentile(95%) = 31.059 ms, percentile(99%) = 31.6201 ms\n[01/27/2025-19:58:44] [I] D2H Latency: min = 0.556885 ms, max = 0.812317 ms, mean = 0.753097 ms, median = 0.758301 ms, percentile(90%) = 0.760498 ms, percentile(95%) = 0.761108 ms, percentile(99%) = 0.798401 ms\n[01/27/2025-19:58:44] [I] Total Host Walltime: 3.11496 s\n[01/27/2025-19:58:44] [I] Total GPU Compute Time: 3.08344 s\n[01/27/2025-19:58:44] [I] Explanations of the performance metrics are printed in the verbose logs.\n[01/27/2025-19:58:44] [I] \n&amp;amp;&amp;amp;&amp;amp;&amp;amp; PASSED TensorRT.trtexec [TensorRT v8603] # trtexec --onnx=/tmp/tmpu9uixbhn/recon/model.onnx --saveEngine=/tmp/tmpu9uixbhn/recon/model.engine --memPoolSize=workspace:4096 --fp16\n\nINFO:test_anomaly_model2:INFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nWARNING:anomalib:OpenVINO is not installed. Please install OpenVINO to use OpenVINOInferencer.\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=[224, 224], mode=padding\nINFO:AnomalyModel v1:Converting pt to onnx...\n/app/anomalib/src/anomalib/models/image/patchcore/torch_model.py:226: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can&amp;#x27;t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n  n_neighbors=min(self.num_neighbors, memory_bank_effective_size),\n/usr/local/lib/python3.10/dist-packages/torch/onnx/symbolic_opset9.py:5858: UserWarning: Exporting aten::index operator of advanced indexing in opset 14 is achieved by combination of multiple ONNX operators, including Reshape, Transpose, Concat, and Gather. If indices include negative values, the exported graph will produce incorrect results.\n  warnings.warn(\n/usr/local/lib/python3.10/dist-packages/torch/onnx/_internal/jit_utils.py:307: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_node_shape_type_inference(node, params_dict, opset_version)\n/usr/local/lib/python3.10/dist-packages/torch/onnx/utils.py:702: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_graph_shape_type_inference(\n/usr/local/lib/python3.10/dist-packages/torch/onnx/utils.py:1208: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_graph_shape_type_inference(\nINFO:AnomalyModel v1:the onnx model is saved at /tmp/tmpu9uixbhn/recon/model.onnx\nINFO:AnomalyModel v1:Converting onnx to trt engine...\n[01/27/2025-19:54:58] [W] [TRT] onnx2trt_utils.cpp:374: Your ONNX model has been generated with INT64 weights, while TensorRT does not natively support INT64. Attempting to cast down to INT32.\n[01/27/2025-19:54:58] [W] [TRT] Tensor DataType is determined at build time for tensors not marked as input or output.\n[01/27/2025-19:54:58] [W] [TRT] Tensor DataType is determined at build time for tensors not marked as input or output.\n[01/27/2025-19:54:58] [W] [TRT] onnx2trt_utils.cpp:400: One or more weights outside the range of INT32 was clamped\n[01/27/2025-19:58:40] [W] [TRT] TensorRT encountered issues when converting weights between types and that could affect accuracy.\n[01/27/2025-19:58:40] [W] [TRT] If this is not the desired behavior, please modify the weights or retrain with regularization to adjust the magnitude of the weights.\n[01/27/2025-19:58:40] [W] [TRT] Check verbose logs for the list of affected weights.\n[01/27/2025-19:58:40] [W] [TRT] - 47 weights are affected by this issue: Detected subnormal FP16 values.\n[01/27/2025-19:58:40] [W] [TRT] - 34 weights are affected by this issue: Detected values less than smallest positive FP16 subnormal value and converted them to the FP16 minimum subnormalized value.\n[01/27/2025-19:58:40] [W] [TRT] - 2 weights are affected by this issue: Detected finite FP32 values which would overflow in FP16 and converted them to the closest finite FP16 value.\n[01/27/2025-19:58:44] [W] * GPU compute time is unstable, with coefficient of variance = 1.55144%.\n[01/27/2025-19:58:44] [W]   If not already in use, locking GPU clock frequency or adding --useSpinWait may improve the stability.\ncp: &amp;#x27;/tmp/tmpu9uixbhn/recon/metadata.json&amp;#x27; and &amp;#x27;/tmp/tmpu9uixbhn/recon/metadata.json&amp;#x27; are the same file\n\n\n------------------------------ Captured log call -------------------------------\nINFO     test_anomaly_model2:test_anomaly_model2.py:210 running cmd: python -m anomalib_lmi.anomaly_model2 test -i tests/assets/models/ad/model_v1.pt -d tests/assets/images/nvtec-ad -o /tmp/tmpu9uixbhn -g -p --tile 224 224 --stride 224 224 --resize\nINFO     test_anomaly_model2:test_anomaly_model2.py:212 \nINFO     test_anomaly_model2:test_anomaly_model2.py:213 INFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nWARNING:anomalib:OpenVINO is not installed. Please install OpenVINO to use OpenVINOInferencer.\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=[224, 224], mode=interpolation\nINFO:AnomalyModel v1:8 images from tests/assets/images/nvtec-ad\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/004-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/003-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/000-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/002-good.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Processing image: tests/assets/images/nvtec-ad/001-bad.png.\nWARNING:Tiler:resize img from [1024, 1024] to (1120, 1120)\nINFO:AnomalyModel v1:Computing anomaly score PDF for all data.\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\nINFO:AnomalyModel v1:Anomaly patch threshold for 50% patch failure rate:38.82902766443839\nINFO:AnomalyModel v1:Anomaly max set to 97 percentile:77.97194934511214\nINFO:AnomalyModel v1:Min Proc Time: 0.4532439708709717\nINFO:AnomalyModel v1:Max Proc Time: 0.7421057224273682\nINFO:AnomalyModel v1:Avg Proc Time: 0.4925464689731598\nINFO:AnomalyModel v1:Median Proc Time: 0.4577251672744751\nINFO:AnomalyModel v1:Test results saved to /tmp/tmpu9uixbhn\nINFO:AnomalyModel v1:Threshold options:\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Threshold             |  13.5 |  20.8 |  28.1 |  35.3 |  42.6 |  49.9 |  57.2  |  64.5  | 71.8   | 79.1   |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Patch Defect  | 100   |  98.2 |  87.4 |  63.5 |  36.2 |  16.5 |   6.18 |   1.97 |  0.549 |  0.137 |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n| Prob of Sample Defect | 100   | 100   | 100   | 100   | 100   | 100   | 100    | 100    | 37.5   |  0     |\n+-----------------------+-------+-------+-------+-------+-------+-------+--------+--------+--------+--------+\n\nINFO     test_anomaly_model2:test_anomaly_model2.py:221 running cmd: python -m anomalib_lmi.anomaly_model2 convert -i tests/assets/models/ad/model_v1.pt -o /tmp/tmpu9uixbhn/recon --hw 1120 1120 --tile 224 224 --stride 224 224\nINFO     test_anomaly_model2:test_anomaly_model2.py:223 &amp;amp;&amp;amp;&amp;amp;&amp;amp; RUNNING TensorRT.trtexec [TensorRT v8603] # trtexec --onnx=/tmp/tmpu9uixbhn/recon/model.onnx --saveEngine=/tmp/tmpu9uixbhn/recon/model.engine --memPoolSize=workspace:4096 --fp16\n[01/27/2025-19:54:53] [I] === Model Options ===\n[01/27/2025-19:54:53] [I] Format: ONNX\n[01/27/2025-19:54:53] [I] Model: /tmp/tmpu9uixbhn/recon/model.onnx\n[01/27/2025-19:54:53] [I] Output:\n[01/27/2025-19:54:53] [I] === Build Options ===\n[01/27/2025-19:54:53] [I] Max batch: explicit batch\n[01/27/2025-19:54:53] [I] Memory Pools: workspace: 4096 MiB, dlaSRAM: default, dlaLocalDRAM: default, dlaGlobalDRAM: default\n[01/27/2025-19:54:53] [I] minTiming: 1\n[01/27/2025-19:54:53] [I] avgTiming: 8\n[01/27/2025-19:54:53] [I] Precision: FP32+FP16\n[01/27/2025-19:54:53] [I] LayerPrecisions: \n[01/27/2025-19:54:53] [I] Layer Device Types: \n[01/27/2025-19:54:53] [I] Calibration: \n[01/27/2025-19:54:53] [I] Refit: Disabled\n[01/27/2025-19:54:53] [I] Version Compatible: Disabled\n[01/27/2025-19:54:53] [I] ONNX Native InstanceNorm: Disabled\n[01/27/2025-19:54:53] [I] TensorRT runtime: full\n[01/27/2025-19:54:53] [I] Lean DLL Path: \n[01/27/2025-19:54:53] [I] Tempfile Controls: { in_memory: allow, temporary: allow }\n[01/27/2025-19:54:53] [I] Exclude Lean Runtime: Disabled\n[01/27/2025-19:54:53] [I] Sparsity: Disabled\n[01/27/2025-19:54:53] [I] Safe mode: Disabled\n[01/27/2025-19:54:53] [I] Build DLA standalone loadable: Disabled\n[01/27/2025-19:54:53] [I] Allow GPU fallback for DLA: Disabled\n[01/27/2025-19:54:53] [I] DirectIO mode: Disabled\n[01/27/2025-19:54:53] [I] Restricted mode: Disabled\n[01/27/2025-19:54:53] [I] Skip inference: Disabled\n[01/27/2025-19:54:53] [I] Save engine: /tmp/tmpu9uixbhn/recon/model.engine\n[01/27/2025-19:54:53] [I] Load engine: \n[01/27/2025-19:54:53] [I] Profiling verbosity: 0\n[01/27/2025-19:54:53] [I] Tactic sources: Using default tactic sources\n[01/27/2025-19:54:53] [I] timingCacheMode: local\n[01/27/2025-19:54:53] [I] timingCacheFile: \n[01/27/2025-19:54:53] [I] Heuristic: Disabled\n[01/27/2025-19:54:53] [I] Preview Features: Use default preview flags.\n[01/27/2025-19:54:53] [I] MaxAuxStreams: -1\n[01/27/2025-19:54:53] [I] BuilderOptimizationLevel: -1\n[01/27/2025-19:54:53] [I] Input(s)s format: fp32:CHW\n[01/27/2025-19:54:53] [I] Output(s)s format: fp32:CHW\n[01/27/2025-19:54:53] [I] Input build shapes: model\n[01/27/2025-19:54:53] [I] Input calibration shapes: model\n[01/27/2025-19:54:53] [I] === System Options ===\n[01/27/2025-19:54:53] [I] Device: 0\n[01/27/2025-19:54:53] [I] DLACore: \n[01/27/2025-19:54:53] [I] Plugins:\n[01/27/2025-19:54:53] [I] setPluginsToSerialize:\n[01/27/2025-19:54:53] [I] dynamicPlugins:\n[01/27/2025-19:54:53] [I] ignoreParsedPluginLibs: 0\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] === Inference Options ===\n[01/27/2025-19:54:53] [I] Batch: Explicit\n[01/27/2025-19:54:53] [I] Input inference shapes: model\n[01/27/2025-19:54:53] [I] Iterations: 10\n[01/27/2025-19:54:53] [I] Duration: 3s (+ 200ms warm up)\n[01/27/2025-19:54:53] [I] Sleep time: 0ms\n[01/27/2025-19:54:53] [I] Idle time: 0ms\n[01/27/2025-19:54:53] [I] Inference Streams: 1\n[01/27/2025-19:54:53] [I] ExposeDMA: Disabled\n[01/27/2025-19:54:53] [I] Data transfers: Enabled\n[01/27/2025-19:54:53] [I] Spin-wait: Disabled\n[01/27/2025-19:54:53] [I] Multithreading: Disabled\n[01/27/2025-19:54:53] [I] CUDA Graph: Disabled\n[01/27/2025-19:54:53] [I] Separate profiling: Disabled\n[01/27/2025-19:54:53] [I] Time Deserialize: Disabled\n[01/27/2025-19:54:53] [I] Time Refit: Disabled\n[01/27/2025-19:54:53] [I] NVTX verbosity: 0\n[01/27/2025-19:54:53] [I] Persistent Cache Ratio: 0\n[01/27/2025-19:54:53] [I] Inputs:\n[01/27/2025-19:54:53] [I] === Reporting Options ===\n[01/27/2025-19:54:53] [I] Verbose: Disabled\n[01/27/2025-19:54:53] [I] Averages: 10 inferences\n[01/27/2025-19:54:53] [I] Percentiles: 90,95,99\n[01/27/2025-19:54:53] [I] Dump refittable layers:Disabled\n[01/27/2025-19:54:53] [I] Dump output: Disabled\n[01/27/2025-19:54:53] [I] Profile: Disabled\n[01/27/2025-19:54:53] [I] Export timing to JSON file: \n[01/27/2025-19:54:53] [I] Export output to JSON file: \n[01/27/2025-19:54:53] [I] Export profile to JSON file: \n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] === Device Information ===\n[01/27/2025-19:54:53] [I] Selected Device: NVIDIA GeForce RTX 4070 Laptop GPU\n[01/27/2025-19:54:53] [I] Compute Capability: 8.9\n[01/27/2025-19:54:53] [I] SMs: 36\n[01/27/2025-19:54:53] [I] Device Global Memory: 7935 MiB\n[01/27/2025-19:54:53] [I] Shared Memory per SM: 100 KiB\n[01/27/2025-19:54:53] [I] Memory Bus Width: 128 bits (ECC disabled)\n[01/27/2025-19:54:53] [I] Application Compute Clock Rate: 1.23 GHz\n[01/27/2025-19:54:53] [I] Application Memory Clock Rate: 8.001 GHz\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] Note: The application clock rates do not reflect the actual clock rates that the GPU is currently running at.\n[01/27/2025-19:54:53] [I] \n[01/27/2025-19:54:53] [I] TensorRT version: 8.6.3\n[01/27/2025-19:54:53] [I] Loading standard plugins\n[01/27/2025-19:54:54] [I] [TRT] [MemUsageChange] Init CUDA: CPU +2, GPU +0, now: CPU 23, GPU 2498 (MiB)\n[01/27/2025-19:54:58] [I] [TRT] [MemUsageChange] Init builder kernel library: CPU +1453, GPU +268, now: CPU 1552, GPU 2766 (MiB)\n[01/27/2025-19:54:58] [I] Start parsing network model.\n[01/27/2025-19:54:58] [I] [TRT] ----------------------------------------------------------------\n[01/27/2025-19:54:58] [I] [TRT] Input filename:   /tmp/tmpu9uixbhn/recon/model.onnx\n[01/27/2025-19:54:58] [I] [TRT] ONNX IR version:  0.0.7\n[01/27/2025-19:54:58] [I] [TRT] Opset version:    14\n[01/27/2025-19:54:58] [I] [TRT] Producer name:    pytorch\n[01/27/2025-19:54:58] [I] [TRT] Producer version: 2.3.0\n[01/27/2025-19:54:58] [I] [TRT] Domain:           \n[01/27/2025-19:54:58] [I] [TRT] Model version:    0\n[01/27/2025-19:54:58] [I] [TRT] Doc string:       \n[01/27/2025-19:54:58] [I] [TRT] ----------------------------------------------------------------\n[01/27/2025-19:54:58] [I] Finished parsing network model. Parse time: 0.148756\n[01/27/2025-19:54:58] [I] [TRT] Graph optimization time: 0.0754481 seconds.\n[01/27/2025-19:54:58] [I] [TRT] Local timing cache in use. Profiling results in this builder pass will not be stored.\n[01/27/2025-19:58:40] [I] [TRT] Detected 1 inputs and 2 output network tensors.\n[01/27/2025-19:58:40] [I] [TRT] Total Host Persistent Memory: 267232\n[01/27/2025-19:58:40] [I] [TRT] Total Device Persistent Memory: 26624\n[01/27/2025-19:58:40] [I] [TRT] Total Scratch Memory: 963072\n[01/27/2025-19:58:40] [I] [TRT] [MemUsageStats] Peak memory usage of TRT CPU/GPU memory allocators: CPU 65 MiB, GPU 1372 MiB\n[01/27/2025-19:58:40] [I] [TRT] [BlockAssignment] Started assigning block shifts. This will take 71 steps to complete.\n[01/27/2025-19:58:40] [I] [TRT] [BlockAssignment] Algorithm ShiftNTopDown took 1.38286ms to assign 8 blocks to 71 nodes requiring 179657728 bytes.\n[01/27/2025-19:58:40] [I] [TRT] Total Activation Memory: 179656704\n[01/27/2025-19:58:40] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in building engine: CPU +51, GPU +59, now: CPU 51, GPU 59 (MiB)\n[01/27/2025-19:58:40] [I] Engine built in 226.909 sec.\n[01/27/2025-19:58:41] [I] [TRT] Loaded engine size: 60 MiB\n[01/27/2025-19:58:41] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in engine deserialization: CPU +0, GPU +58, now: CPU 0, GPU 58 (MiB)\n[01/27/2025-19:58:41] [I] Engine deserialized in 0.0186728 sec.\n[01/27/2025-19:58:41] [I] [TRT] [MS] Running engine with multi stream info\n[01/27/2025-19:58:41] [I] [TRT] [MS] Number of aux streams is 1\n[01/27/2025-19:58:41] [I] [TRT] [MS] Number of total worker streams is 2\n[01/27/2025-19:58:41] [I] [TRT] [MS] The main stream provided by execute/enqueue calls is the first worker stream\n[01/27/2025-19:58:41] [I] [TRT] [MemUsageChange] TensorRT-managed allocation in IExecutionContext creation: CPU +0, GPU +171, now: CPU 0, GPU 229 (MiB)\n[01/27/2025-19:58:41] [I] Setting persistentCacheLimit to 0 bytes.\n[01/27/2025-19:58:41] [I] Using random values for input input\n[01/27/2025-19:58:41] [I] Input binding for input with dimensions 25x3x224x224 is created.\n[01/27/2025-19:58:41] [I] Output binding for 580 with dimensions 25 is created.\n[01/27/2025-19:58:41] [I] Output binding for output with dimensions 25x1x224x224 is created.\n[01/27/2025-19:58:41] [I] Starting inference\n[01/27/2025-19:58:44] [I] Warmup completed 7 queries over 200 ms\n[01/27/2025-19:58:44] [I] Timing trace has 102 queries over 3.11496 s\n[01/27/2025-19:58:44] [I] \n[01/27/2025-19:58:44] [I] === Trace details ===\n[01/27/2025-19:58:44] [I] Trace averages of 10 runs:\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.6797 ms - Host latency: 33.3605 ms (enqueue 0.903571 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 29.8086 ms - Host latency: 32.9657 ms (enqueue 0.810129 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.3813 ms - Host latency: 33.5937 ms (enqueue 0.966522 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.3737 ms - Host latency: 33.5136 ms (enqueue 1.02056 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.1221 ms - Host latency: 33.2979 ms (enqueue 1.10021 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.0676 ms - Host latency: 33.2281 ms (enqueue 1.25354 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.2823 ms - Host latency: 33.4353 ms (enqueue 0.983972 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.2949 ms - Host latency: 33.4742 ms (enqueue 1.0873 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.1419 ms - Host latency: 33.2875 ms (enqueue 1.05886 ms)\n[01/27/2025-19:58:44] [I] Average on 10 runs - GPU latency: 30.154 ms - Host latency: 33.2935 ms (enqueue 1.06074 ms)\n[01/27/2025-19:58:44] [I] \n[01/27/2025-19:58:44] [I] === Performance summary ===\n[01/27/2025-19:58:44] [I] Throughput: 32.7452 qps\n[01/27/2025-19:58:44] [I] Latency: min = 32.5557 ms, max = 34.3112 ms, mean = 33.3445 ms, median = 33.2726 ms, percentile(90%) = 33.8351 ms, percentile(95%) = 34.1353 ms, percentile(99%) = 34.2988 ms\n[01/27/2025-19:58:44] [I] Enqueue Time: min = 0.376221 ms, max = 1.87842 ms, mean = 1.0252 ms, median = 1.00912 ms, percentile(90%) = 1.33667 ms, percentile(95%) = 1.57349 ms, percentile(99%) = 1.84973 ms\n[01/27/2025-19:58:44] [I] H2D Latency: min = 1.62901 ms, max = 2.55597 ms, mean = 2.36164 ms, median = 2.38074 ms, percentile(90%) = 2.46704 ms, percentile(95%) = 2.47839 ms, percentile(99%) = 2.49561 ms\n[01/27/2025-19:58:44] [I] GPU Compute Time: min = 29.5557 ms, max = 31.9836 ms, mean = 30.2298 ms, median = 30.1394 ms, percentile(90%) = 30.8726 ms, percentile(95%) = 31.059 ms, percentile(99%) = 31.6201 ms\n[01/27/2025-19:58:44] [I] D2H Latency: min = 0.556885 ms, max = 0.812317 ms, mean = 0.753097 ms, median = 0.758301 ms, percentile(90%) = 0.760498 ms, percentile(95%) = 0.761108 ms, percentile(99%) = 0.798401 ms\n[01/27/2025-19:58:44] [I] Total Host Walltime: 3.11496 s\n[01/27/2025-19:58:44] [I] Total GPU Compute Time: 3.08344 s\n[01/27/2025-19:58:44] [I] Explanations of the performance metrics are printed in the verbose logs.\n[01/27/2025-19:58:44] [I] \n&amp;amp;&amp;amp;&amp;amp;&amp;amp; PASSED TensorRT.trtexec [TensorRT v8603] # trtexec --onnx=/tmp/tmpu9uixbhn/recon/model.onnx --saveEngine=/tmp/tmpu9uixbhn/recon/model.engine --memPoolSize=workspace:4096 --fp16\n\nINFO     test_anomaly_model2:test_anomaly_model2.py:224 INFO:AnomalyModel v1:Loading model: tests/assets/models/ad/model_v1.pt\nWARNING:anomalib:OpenVINO is not installed. Please install OpenVINO to use OpenVINOInferencer.\nINFO:AnomalyModel v1:Model metadata: {&amp;#x27;task&amp;#x27;: &amp;lt;TaskType.SEGMENTATION: &amp;#x27;segmentation&amp;#x27;&amp;gt;, &amp;#x27;image_threshold&amp;#x27;: 27.615890502929688, &amp;#x27;pixel_threshold&amp;#x27;: 46.97408676147461, &amp;#x27;anomaly_maps.min&amp;#x27;: 6.475015640258789, &amp;#x27;anomaly_maps.max&amp;#x27;: 59.93198776245117, &amp;#x27;pred_scores.min&amp;#x27;: 27.615890502929688, &amp;#x27;pred_scores.max&amp;#x27;: 61.39303970336914}\nINFO:AnomalyModel v1:init tiler with tile=[224, 224], stride=[224, 224], mode=padding\nINFO:AnomalyModel v1:Converting pt to onnx...\n/app/anomalib/src/anomalib/models/image/patchcore/torch_model.py:226: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be incorrect. We can&amp;#x27;t record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other inputs!\n  n_neighbors=min(self.num_neighbors, memory_bank_effective_size),\n/usr/local/lib/python3.10/dist-packages/torch/onnx/symbolic_opset9.py:5858: UserWarning: Exporting aten::index operator of advanced indexing in opset 14 is achieved by combination of multiple ONNX operators, including Reshape, Transpose, Concat, and Gather. If indices include negative values, the exported graph will produce incorrect results.\n  warnings.warn(\n/usr/local/lib/python3.10/dist-packages/torch/onnx/_internal/jit_utils.py:307: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_node_shape_type_inference(node, params_dict, opset_version)\n/usr/local/lib/python3.10/dist-packages/torch/onnx/utils.py:702: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_graph_shape_type_inference(\n/usr/local/lib/python3.10/dist-packages/torch/onnx/utils.py:1208: UserWarning: Constant folding - Only steps=1 can be constant folded for opset &amp;gt;= 10 onnx::Slice op. Constant folding not applied. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/jit/passes/onnx/constant_fold.cpp:179.)\n  _C._jit_pass_onnx_graph_shape_type_inference(\nINFO:AnomalyModel v1:the onnx model is saved at /tmp/tmpu9uixbhn/recon/model.onnx\nINFO:AnomalyModel v1:Converting onnx to trt engine...\n[01/27/2025-19:54:58] [W] [TRT] onnx2trt_utils.cpp:374: Your ONNX model has been generated with INT64 weights, while TensorRT does not natively support INT64. Attempting to cast down to INT32.\n[01/27/2025-19:54:58] [W] [TRT] Tensor DataType is determined at build time for tensors not marked as input or output.\n[01/27/2025-19:54:58] [W] [TRT] Tensor DataType is determined at build time for tensors not marked as input or output.\n[01/27/2025-19:54:58] [W] [TRT] onnx2trt_utils.cpp:400: One or more weights outside the range of INT32 was clamped\n[01/27/2025-19:58:40] [W] [TRT] TensorRT encountered issues when converting weights between types and that could affect accuracy.\n[01/27/2025-19:58:40] [W] [TRT] If this is not the desired behavior, please modify the weights or retrain with regularization to adjust the magnitude of the weights.\n[01/27/2025-19:58:40] [W] [TRT] Check verbose logs for the list of affected weights.\n[01/27/2025-19:58:40] [W] [TRT] - 47 weights are affected by this issue: Detected subnormal FP16 values.\n[01/27/2025-19:58:40] [W] [TRT] - 34 weights are affected by this issue: Detected values less than smallest positive FP16 subnormal value and converted them to the FP16 minimum subnormalized value.\n[01/27/2025-19:58:40] [W] [TRT] - 2 weights are affected by this issue: Detected finite FP32 values which would overflow in FP16 and converted them to the closest finite FP16 value.\n[01/27/2025-19:58:44] [W] * GPU compute time is unstable, with coefficient of variance = 1.55144%.\n[01/27/2025-19:58:44] [W]   If not already in use, locking GPU clock frequency or adding --useSpinWait may improve the stability.\ncp: &amp;#x27;/tmp/tmpu9uixbhn/recon/metadata.json&amp;#x27; and &amp;#x27;/tmp/tmpu9uixbhn/recon/metadata.json&amp;#x27; are the same file\n\n&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;anomaly_detectors_v1.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>